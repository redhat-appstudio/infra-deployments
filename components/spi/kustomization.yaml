namePrefix: spi-

resources:
  - https://github.com/sparkoo/service-provider-integration-operator/config/default?ref=2d90b1b95a148574d6a38da44385811e92d282b6
  - oauth_route.yaml

patchesStrategicMerge:
- oauth_ingress_patch_delete.yaml

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

secretGenerator:
  - name: oauth-config
    files:
      - config.yaml

replacements:
  - source:
      kind: Route
      name: oauth-route
      fieldPath: spec.host
    targets:
      - select:
          kind: Deployment
        fieldPaths:
          - spec.template.spec.containers.[name=oauth].env.[name=OAUTH_BASE_URL].value
          - spec.template.spec.containers.[name=manager].env.[name=OAUTH_BASE_URL].value

images:
  - name:  quay.io/redhat-appstudio/service-provider-integration-operator
    newName: quay.io/mvala/spi-operator
    newTag: svpi48-config
  - name: quay.io/redhat-appstudio/service-provider-integration-oauth
    newName: quay.io/mvala/spi-oauth
    newTag: svpi48-config

namespace: spi-system
