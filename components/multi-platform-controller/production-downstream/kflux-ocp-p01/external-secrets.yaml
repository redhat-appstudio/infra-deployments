apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: aws-account
  namespace: multi-platform-controller
  labels:
    build.appstudio.redhat.com/multi-platform-secret: "true"
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "-1"
spec:
  dataFrom:
    - extract:
        key: production/build/multi-platform-controller/kflux-ocp-p01-aws-account
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: appsre-stonesoup-vault
  target:
    creationPolicy: Owner
    deletionPolicy: Delete
    name: aws-account
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: aws-ssh-key
  namespace: multi-platform-controller
  labels:
    build.appstudio.redhat.com/multi-platform-secret: "true"
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "-1"
spec:
  dataFrom:
    - extract:
        key: production/build/multi-platform-controller/kflux-ocp-p01-ssh-key
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: appsre-stonesoup-vault
  target:
    creationPolicy: Owner
    deletionPolicy: Delete
    name: aws-ssh-key
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: internal-prod-ibm-api-key
  namespace: multi-platform-controller
  labels:
    build.appstudio.redhat.com/multi-platform-secret: "true"
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "-1"
spec:
  dataFrom:
    - extract:
        key: production/build/multi-platform-controller/kflux-ocp-p01-ibm-api-key
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: appsre-stonesoup-vault
  target:
    creationPolicy: Owner
    deletionPolicy: Delete
    name: internal-prod-ibm-api-key
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: ibm-ppc64le-ssh-key
  namespace: multi-platform-controller
  labels:
    build.appstudio.redhat.com/multi-platform-secret: "true"
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "-1"
spec:
  dataFrom:
    - extract:
        key: production/platform/terraform/generated/kflux-ocp-p01/ibm-ppc64le-ssh-key
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: appsre-stonesoup-vault
  target:
    creationPolicy: Owner
    deletionPolicy: Delete
    name: ibm-ppc64le-ssh-key
## we are missing the ssh key for s390x, must have been only created in the cluster
