---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../development
  - external-secret.yaml

patches:
  - patch: |-
      $patch: delete
      apiVersion: v1
      kind: Secret
      metadata:
        name: kubearchive-logging
        namespace: kubearchive

  - patch: |-
      apiVersion: batch/v1
      kind: CronJob
      metadata:
        name: vacuum-all
      spec:
        jobTemplate:
          spec:
            template:
              spec:
                containers:
                  - name: vacuum
                    resources:
                      requests:
                        cpu: 100m
                        memory: 1Gi
                      limits:
                        cpu: 100m
                        memory: 1Gi
