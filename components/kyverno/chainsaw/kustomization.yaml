apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: konflux-kyverno

resources:
- namespace.yaml

generators:
- kyverno-helm-generator.yaml

images:
  - name: reg.kyverno.io/kyverno/kyverno
    newName: quay.io/konflux-ci/kyverno/kyverno
    newTag: 04693a87a136a7600b0c5e65b5694190ee6515e8
  - name: reg.kyverno.io/kyverno/kyvernopre
    newName: quay.io/konflux-ci/kyverno/kyverno-init
    newTag: 04693a87a136a7600b0c5e65b5694190ee6515e8
  - name: reg.kyverno.io/kyverno/background-controller
    newName: quay.io/konflux-ci/kyverno/kyverno-background
    newTag: 04693a87a136a7600b0c5e65b5694190ee6515e8
  - name: reg.kyverno.io/kyverno/cleanup-controller
    newName: quay.io/konflux-ci/kyverno/kyverno-cleanup
    newTag: 04693a87a136a7600b0c5e65b5694190ee6515e8
  - name: reg.kyverno.io/kyverno/kyverno-cli
    newName: quay.io/konflux-ci/kyverno/kyverno-cli
    newTag: 04693a87a136a7600b0c5e65b5694190ee6515e8

# set resources to jobs
patches:
  - path: job_resources.yaml
    target:
      group: batch
      version: v1
      kind: Job
      name: konflux-kyverno-migrate-resources
  - path: job_resources.yaml
    target:
      group: batch
      version: v1
      kind: Job
      name: konflux-kyverno-remove-configmap
