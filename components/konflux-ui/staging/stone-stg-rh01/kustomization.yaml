apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../base
# Remove this comment to rotate dex and proxy secrets
# - ./configure-oauth-proxy-secret.yaml

configMapGenerator:
- files:
  - dex-config.yaml
  name: dex
- name: ui-runtime-env-variables
  literals:
  - CHAT_BOT_ENABLED=true
  - CHAT_BOT_ASSISTANT_ID=e9f66a4f-5554-480f-9993-96212b0ecb41
  - CHAT_BOT_ENVIRONMENT_ID=ce429131-2a37-4560-ad69-963d16a0a5c7
  - CHAT_BOT_VERSION=2021-06-14
  - MONITORING_ENABLED=true
  - MONITORING_DSN=https://2d1bbbd05a2ff473d916df439cfc363e@o490301.ingest.us.sentry.io/4510260965408768
  - MONITORING_ENVIRONMENT=staging
  - MONITORING_CLUSTER=stone-stg-rh01
  - MONITORING_SAMPLE_RATE_ERRORS=1.0
patches:
- path: add-service-certs-patch.yaml
  target:
    group: ""
    version: v1
    kind: Service
    name: proxy
- path: oauth2-proxy-args-patch.yaml
  target:
    group: apps
    version: v1
    kind: Deployment
    name: proxy
- path: remove-run-as-user-proxy-patch.yaml
  target:
    group: apps
    version: v1
    kind: Deployment
    name: proxy
- path: set-replicas-patch.yaml
  target:
    group: apps
    version: v1
    kind: Deployment
- path: set-redirect-uri.yaml
  target:
    name: dex-client
    kind: ServiceAccount
- path: set-hostname.yaml
  target:
    kind: Route
    version: v1

namespace: konflux-ui
